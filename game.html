<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Neon Snake — HTML/CSS/JS Game</title>
  <style>
    :root{
      --bg:#0b1020; --card:#0f1724; --accent:#6ee7b7; --muted:#93c5fd;
      --glass: rgba(255,255,255,0.04);
      --radius:16px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#071026 0%,#07141f 100%);color:#dbeafe}
    .app{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px}
    .card{width:100%;max-width:980px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:20px;padding:18px;box-shadow:0 8px 30px rgba(2,6,23,0.6);display:grid;grid-template-columns:1fr 320px;gap:18px}
    header{display:flex;align-items:center;gap:12px}
    h1{font-size:20px;margin:0}
    p.lead{margin:0;font-size:13px;color:var(--muted)}

 
    .game-area{background:linear-gradient(180deg,#071b2b, #041024);border-radius:12px;padding:14px;display:flex;flex-direction:column;align-items:center}
    canvas{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:8px;display:block;width:100%;height:auto;max-width:640px}
    .hud{width:100%;display:flex;justify-content:space-between;align-items:center;margin-top:10px}
    .score{background:var(--glass);padding:8px 12px;border-radius:10px;font-weight:600}
    .controls{display:flex;gap:8px;align-items:center}
    button.btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 12px;border-radius:10px;color:var(--muted);cursor:pointer}
    button.primary{background:linear-gradient(90deg,var(--accent),#60a5fa);color:#021018;border:none}

 
    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:16px;display:flex;flex-direction:column;gap:12px}
    .panel h2{margin:0;font-size:16px}
    .meta{display:flex;justify-content:space-between;gap:8px}
    .meta .big{font-size:22px;font-weight:700}
    .small{font-size:13px;color:var(--muted)}

    
    .touch-controls{display:none;gap:8px;justify-content:center}
    .pad{display:grid;grid-template-columns:repeat(3,64px);gap:8px}
    .pad button{width:64px;height:64px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent}

    footer{font-size:12px;color:var(--muted);text-align:center;margin-top:10px}

    @media (max-width:880px){
      .card{grid-template-columns:1fr;}
      .panel{order:2}
      .touch-controls{display:flex}
      canvas{max-width:720px}
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="card">
      <div class="game-area">
        <header>
          <div>
            <h1>Neon Snake</h1>
            <p class="lead">Classic snake with smooth movement, mobile controls & high-score saving.</p>
          </div>
        </header>

        <canvas id="game" width="640" height="480" aria-label="game canvas"></canvas>

        <div class="hud">
          <div class="score">Score: <span id="score">0</span></div>
          <div class="controls">
            <button id="startBtn" class="btn primary">Start</button>
            <button id="pauseBtn" class="btn">Pause</button>
            <button id="resetBtn" class="btn">Reset</button>
          </div>
        </div>

        <!-- touch controls for mobile -->
        <div class="touch-controls" aria-hidden="false">
          <div class="pad">
            <div></div><button data-dir="up">⬆</button><div></div>
            <button data-dir="left">⬅</button><button data-dir="down">⬇</button><button data-dir="right">➡</button>
          </div>
        </div>

        <footer>Use arrows / WASD. Eat food to grow. Built with ❤</footer>
      </div>

      <aside class="panel">
        <h2>Game Stats</h2>
        <div class="meta">
          <div>
            <div class="small">Current</div>
            <div class="big" id="current">0</div>
          </div>
          <div>
            <div class="small">High Score</div>
            <div class="big" id="high">0</div>
          </div>
        </div>

        <div>
          <h2>Settings</h2>
          <label class="small">Speed: <span id="speedLabel">10</span></label>
          <input id="speedRange" type="range" min="6" max="20" value="10" />
        </div>

        <div>
          <h2>Tips</h2>
          <ul class="small">
            <li>Don't hit the walls — enable wrap mode in future edits to make the board endless.</li>
            <li>Use the on-screen pad when on mobile.</li>
            <li>Try increasing speed for a challenge.</li>
          </ul>
        </div>

        <div>
          <h2>Export</h2>
          <button id="downloadBtn" class="btn">Download as .html</button>
        </div>
      </aside>
    </div>
  </div>

  <script>

    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const startBtn = document.getElementById('startBtn');
    const pauseBtn = document.getElementById('pauseBtn');
    const resetBtn = document.getElementById('resetBtn');
    const scoreEl = document.getElementById('score');
    const currentEl = document.getElementById('current');
    const highEl = document.getElementById('high');
    const speedRange = document.getElementById('speedRange');
    const speedLabel = document.getElementById('speedLabel');
    const downloadBtn = document.getElementById('downloadBtn');

    
    function fitCanvas() {
      const maxWidth = Math.min(window.innerWidth - 120, 640);
      const ratio = canvas.width / canvas.height;
      canvas.style.width = Math.round(maxWidth) + 'px';
      canvas.style.height = Math.round(maxWidth / ratio) + 'px';
    }
    window.addEventListener('resize', fitCanvas);
    fitCanvas();

    const gridSize = 20; 
    let cols = Math.floor(canvas.width / gridSize);
    let rows = Math.floor(canvas.height / gridSize);

    let snake = [{x: Math.floor(cols/2), y: Math.floor(rows/2)}];
    let dir = {x:1,y:0};
    let nextDir = {x:1,y:0};
    let food = null;
    let frame = 0;
    let speed = Number(speedRange.value);
    let playing = false;
    let paused = false;
    let score = 0;
    const storageKey = 'neon-snake-highscore-v1';


    function resetGame(){
      cols = Math.floor(canvas.width / gridSize);
      rows = Math.floor(canvas.height / gridSize);
      snake = [{x: Math.floor(cols/2), y: Math.floor(rows/2)}];
      dir = {x:1,y:0}; nextDir = {x:1,y:0};
      placeFood();
      frame = 0; score = 0; updateHUD();
      playing = false; paused = false;
    }

    function placeFood(){
      let tries=0;
      while(true){
        const f = {x: Math.floor(Math.random()*cols), y: Math.floor(Math.random()*rows)};
        if(!snake.some(s=>s.x===f.x && s.y===f.y)) { food = f; break; }
        if(++tries>500) break;
      }
    }

    function updateHUD(){
      scoreEl.textContent = score;
      currentEl.textContent = score;
      highEl.textContent = localStorage.getItem(storageKey) || 0;
      speedLabel.textContent = speed;
    }

 
    function draw(){
   
      ctx.fillStyle = '#041220';
      ctx.fillRect(0,0,canvas.width,canvas.height);

   
      ctx.strokeStyle = 'rgba(255,255,255,0.02)';
      for(let x=0;x<cols;x++){
        ctx.beginPath();ctx.moveTo(x*gridSize,0);ctx.lineTo(x*gridSize,canvas.height);ctx.stroke();
      }
      for(let y=0;y<rows;y++){
        ctx.beginPath();ctx.moveTo(0,y*gridSize);ctx.lineTo(canvas.width,y*gridSize);ctx.stroke();
      }

      if(food){
        drawCell(food.x, food.y, '#ff6b6b', true);
      }

  
      snake.forEach((s,i)=>{
        const hue = 180 + (i/snake.length)*120;
        const c = `hsl(${hue} 90% 60%)`;
        drawCell(s.x,s.y,c,i===0);
      });
    }

    function drawCell(cx,cy,color,isHead){
      const x = cx*gridSize + 2;
      const y = cy*gridSize + 2;
      const w = gridSize - 4;
      const h = gridSize - 4;

      ctx.shadowBlur = isHead?18:8;
      ctx.shadowColor = color;
      ctx.fillStyle = color;
      roundRect(ctx,x,y,w,h,6,true,false);
      ctx.shadowBlur = 0;
    }

    function roundRect(ctx, x, y, width, height, radius, fill, stroke) {
      if (typeof stroke === 'undefined') stroke = true;
      if (typeof radius === 'undefined') radius = 5;
      if (typeof radius === 'number') radius = {tl: radius, tr: radius, br: radius, bl: radius};
      ctx.beginPath();
      ctx.moveTo(x + radius.tl, y);
      ctx.lineTo(x + width - radius.tr, y);
      ctx.quadraticCurveTo(x + width, y, x + width, y + radius.tr);
      ctx.lineTo(x + width, y + height - radius.br);
      ctx.quadraticCurveTo(x + width, y + height, x + width - radius.br, y + height);
      ctx.lineTo(x + radius.bl, y + height);
      ctx.quadraticCurveTo(x, y + height, x, y + height - radius.bl);
      ctx.lineTo(x, y + radius.tl);
      ctx.quadraticCurveTo(x, y, x + radius.tl, y);
      ctx.closePath();
      if (fill) ctx.fill();
      if (stroke) ctx.stroke();
    }

  
    function step(){
      if(!playing || paused) return;
      frame++;
      const ticksPerMove = Math.max(1, Math.round(60 / speed));
      if(frame % ticksPerMove !== 0) return;

      dir = nextDir;
      const head = {x: snake[0].x + dir.x, y: snake[0].y + dir.y};

    
      if(head.x < 0 || head.x >= cols || head.y < 0 || head.y >= rows){
        gameOver(); return;
      }

     
      if(snake.some(s=>s.x===head.x && s.y===head.y)){ gameOver(); return; }

      snake.unshift(head);
     
      if(food && head.x===food.x && head.y===food.y){
        score += 10; placeFood(); updateHUD(); playBeep(800,0.03);
      } else {
        snake.pop();
      }
    }

    function gameOver(){
      playing = false; paused = false;
      playBeep(120,0.2);
      const high = Number(localStorage.getItem(storageKey) || 0);
      if(score > high) localStorage.setItem(storageKey, score);
      updateHUD();
      alert('Game over! Score: ' + score + '\nPress Start to play again.');
      resetGame();
    }

    function loop(){
      step(); draw(); requestAnimationFrame(loop);
    }


    window.addEventListener('keydown', e=>{
      const k = e.key.toLowerCase();
      if(['arrowup','w'].includes(k) || k==='w') setDirection(0,-1);
      if(['arrowdown','s'].includes(k) || k==='s') setDirection(0,1);
      if(['arrowleft','a'].includes(k) || k==='a') setDirection(-1,0);
      if(['arrowright','d'].includes(k) || k==='d') setDirection(1,0);
      if(k===' '){ paused = !paused; }
    });

    function setDirection(x,y){
   
      if((x === -dir.x && y === -dir.y) && snake.length>1) return;
      nextDir = {x,y};
    }

 
    startBtn.addEventListener('click', ()=>{
      if(!playing){ playing = true; paused = false; }
      startBtn.textContent = 'Playing';
      playBeep(1200,0.04);
    });
    pauseBtn.addEventListener('click', ()=>{
      paused = !paused; pauseBtn.textContent = paused? 'Resume':'Pause';
    });
    resetBtn.addEventListener('click', ()=>{ resetGame(); updateHUD(); });

 
    document.querySelectorAll('[data-dir]').forEach(b=>{
      b.addEventListener('touchstart', e=>{ e.preventDefault(); const d = b.dataset.dir; handlePad(d); });
      b.addEventListener('mousedown', e=>{ const d = b.dataset.dir; handlePad(d); });
    });
    function handlePad(dirStr){
      if(dirStr==='up') setDirection(0,-1);
      if(dirStr==='down') setDirection(0,1);
      if(dirStr==='left') setDirection(-1,0);
      if(dirStr==='right') setDirection(1,0);
      if(!playing){ playing=true; }
    }

   
    speedRange.addEventListener('input', ()=>{ speed = Number(speedRange.value); speedLabel.textContent = speed; updateHUD(); });


    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playBeep(freq=440, time=0.05){
      try{
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = 'sine'; o.frequency.value = freq;
        g.gain.value = time>0?0.06:0;
        o.connect(g); g.connect(audioCtx.destination);
        o.start();
        g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + time);
        setTimeout(()=>{ o.stop(); o.disconnect(); g.disconnect(); }, time*1000 + 50);
      }catch(e){/* audio blocked */}
    }

  
    downloadBtn.addEventListener('click', ()=>{
      const blob = new Blob([document.documentElement.outerHTML], {type:'text/html'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'neon-snake.html'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

 
    resetGame(); updateHUD(); loop();

  
    (function enhanceCanvas(){
      const dpr = window.devicePixelRatio || 1;
      if(dpr===1) return;
      const oldW = canvas.width, oldH = canvas.height;
      canvas.width = oldW * dpr; canvas.height = oldH * dpr;
      canvas.style.width = oldW + 'px'; canvas.style.height = oldH + 'px';
      ctx.setTransform(dpr,0,0,dpr,0,0);
    })();
  </script>
</body>
</html>